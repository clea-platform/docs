"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[98],{1916:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"get_started/create_a_clea_portal_app","title":"Create a third-party Clea Portal App","description":"The Platform supports loading external web apps that can be developed by third-party actors.","source":"@site/docs/2_get_started/2-create_a_clea_portal_app.md","sourceDirName":"2_get_started","slug":"/get_started/create_a_clea_portal_app","permalink":"/get_started/create_a_clea_portal_app","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2}}');var a=n(4848),i=n(8453);const r={sidebar_position:2},l="Create a third-party Clea Portal App",o={},d=[{value:"Requirements",id:"requirements",level:2},{value:"Availability",id:"availability",level:3},{value:"Bundle format",id:"bundle-format",level:3},{value:"Bundle content",id:"bundle-content",level:3},{value:"App props",id:"app-props",level:4},{value:"Settings",id:"settings",level:4},{value:"Styling the App",id:"styling-the-app",level:2},{value:"Limitations",id:"limitations",level:2},{value:"Example apps",id:"example-apps",level:2},{value:"Registering an app on the Platform",id:"registering-an-app-on-the-platform",level:2}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"create-a-third-party-clea-portal-app",children:"Create a third-party Clea Portal App"})}),"\n",(0,a.jsx)(t.p,{children:"The Platform supports loading external web apps that can be developed by third-party actors."}),"\n",(0,a.jsxs)(t.p,{children:["A ",(0,a.jsx)(t.strong,{children:"Clea Portal App"})," consists of an external web application encapsulated within Clea Portal as a shadow DOM."]}),"\n",(0,a.jsx)(t.p,{children:"The App is viewable in any appliance depending on its compatibility with supported Astarte interfaces. When it comes to authentication and data collection, it requires interaction with Astarte APIs."}),"\n",(0,a.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,a.jsx)(t.p,{children:"To ensure interoperability with the Platform, an app must meet the following criteria:"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Availability"}),": the app is made available at a public URL as a single JavaScript file bundle;"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Bundle format"}),": the app\u2019s bundle must be a JavaScript ES Module;"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Bundle content"}),": the default export of the app must be an object to handle the app\u2019s lifecycle. More on this later."]}),"\n"]}),"\n",(0,a.jsx)(t.h3,{id:"availability",children:"Availability"}),"\n",(0,a.jsx)(t.p,{children:"The app must be accessible at a public URL and served with appropriate CORS configuration in order to be fetched from the Platform web app."}),"\n",(0,a.jsx)(t.h3,{id:"bundle-format",children:"Bundle format"}),"\n",(0,a.jsxs)(t.p,{children:["The app must be a single file bundle that can be parsed as an ",(0,a.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules",children:"ES Module"}),"."]}),"\n",(0,a.jsx)(t.h3,{id:"bundle-content",children:"Bundle content"}),"\n",(0,a.jsx)(t.p,{children:"The app\u2019s bundle must have a default export with the following object structure, using TypeScript signatures:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"{\n  mount: (\n    container: HTMLElement,\n    props: AppProps,\n    settings: Settings\n  ) => void;\n  unmount: (container: HTMLElement) => void;\n}\n"})}),"\n",(0,a.jsx)(t.p,{children:"where:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"mount"})," is a synchronous function that will be called to instantiate the app inside a Platform\u2019s page. ",(0,a.jsx)(t.code,{children:"container"})," is the DOM element within which the app must render itself, while ",(0,a.jsx)(t.code,{children:"props"})," and ",(0,a.jsx)(t.code,{children:"settings"})," are objects supplied by the Platform. Read the dedicated paragraph below for further details about the ",(0,a.jsx)(t.code,{children:"props"})," and ",(0,a.jsx)(t.code,{children:"settings"})," objects."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"unmount"})," is a synchronous function that will be called to dispose of the app\u2019s instance, if any cleanup should be done. ",(0,a.jsx)(t.code,{children:"container"})," is the DOM element where the app was instantiated on."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"These lifecycle methods are intended to be lightweight and should return quickly. If the app requires a long setup, that should be handled separately."}),"\n",(0,a.jsx)(t.h4,{id:"app-props",children:"App props"}),"\n",(0,a.jsxs)(t.p,{children:["Upon mount, the app will be provided with a ",(0,a.jsx)(t.code,{children:"props"})," object that has the following type signature:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"type AppProps = {\n  astarteUrl: URL;\n  realm: string;\n  token: string;\n  deviceId: string;\n}\n"})}),"\n",(0,a.jsx)(t.p,{children:"Thus you will have access to the following parameters:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"astarteUrl"})," is a URL object pointing to an Astarte instance."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"realm"})," refers to the Astarte realm."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"token"})," is the authentication token to access Astarte services."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"deviceId"})," refers to the Astarte device ID used also as Clea unique identifier."]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["The Astarte token grants permissions to access Astarte services in order to query for interface data on the device with ID ",(0,a.jsx)(t.code,{children:"deviceId"}),". You can look at Astarte\u2019s documentation to know about ",(0,a.jsx)(t.a,{href:"https://docs.astarte-platform.org/1.0/050-query_device.html",children:"querying a device"})," or the ",(0,a.jsx)(t.a,{href:"https://docs.astarte-platform.org/1.0/001-intro_api.html",children:"REST API reference"}),"."]}),"\n",(0,a.jsx)(t.h4,{id:"settings",children:"Settings"}),"\n",(0,a.jsx)(t.p,{children:"The settings object contains data to have a congruent experience with Clea"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"type Settings = {\n  themeUrl: string;\n  userPreferences: UserPreferences;\n}\n\ntype UserPreferences = {\n  language: string;\n};\n"})}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"themeUrl"})," contains the URL or a relative path of the css style used by Clea. You can incorporate this in the App using a link tag to have the same look and feel of Clea."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"language"})," is the language selected by the user logged in using the ",(0,a.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/ISO_639-1",children:"ISO 639-1"})," format. When no language is selected, it defaults to \u201cen\u201d for english."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"styling-the-app",children:"Styling the App"}),"\n",(0,a.jsx)(t.p,{children:"DOM elements can be styled as usual with inline styles or CSS id and classes. Inline styles aside, CSS styles can only be declared with one or multiple <style> or <link> tags in the top level of the App container provided during the mount phase."}),"\n",(0,a.jsx)(t.p,{children:"The App is mounted inside a shadow DOM, so style declared there won\u2019t leak outside and vice versa."}),"\n",(0,a.jsxs)(t.p,{children:["Clea uses a customized version of ",(0,a.jsx)(t.a,{href:"https://getbootstrap.com/docs/5.1/getting-started/introduction/",children:"Bootstrap 5.1"}),". The stylesheet file used by Clea is provided to external apps via the themeUrl parameter (see also ",(0,a.jsx)(t.a,{href:"#settings",children:"Settings"})," section)."]}),"\n",(0,a.jsx)(t.h2,{id:"limitations",children:"Limitations"}),"\n",(0,a.jsxs)(t.p,{children:["The Platform supports third-party apps thanks to modern technologies such as ES Modules. As such, apps run on browsers that support such features. You can look at the ",(0,a.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules#browser_support",children:"compatibility matrixes"})," for details about browser support."]}),"\n",(0,a.jsx)(t.p,{children:"Since the app is loaded as a module inside a Platform\u2019s web page, JavaScript methods that modify global state of the page must be avoided; these forbidden actions include:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Changing the page\u2019s location or history."}),"\n",(0,a.jsxs)(t.li,{children:["Interacting with the browser\u2019s storages such as ",(0,a.jsx)(t.code,{children:"localStorage"}),"."]}),"\n",(0,a.jsxs)(t.li,{children:["Using global variables or modifying the ",(0,a.jsx)(t.code,{children:"window"})," object."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"example-apps",children:"Example apps"}),"\n",(0,a.jsxs)(t.p,{children:["You can look at the sample boilerplate codes (React + Typescript) for app development that are provided in the ",(0,a.jsx)(t.a,{href:"https://github.com/clea-platform/clea-examples",children:"Clea Examples"})," repository."]}),"\n",(0,a.jsx)(t.h2,{id:"registering-an-app-on-the-platform",children:"Registering an app on the Platform"}),"\n",(0,a.jsxs)(t.p,{children:["The Platform provides a dedicated section to register third-party Clea Portal Apps. Check how to do that in the ",(0,a.jsx)(t.a,{href:"/clea_portal_walkthrough/admin_console#tenant-applications",children:"Tenant Applications"})," section on the Admin Console page."]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var s=n(6540);const a={},i=s.createContext(a);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);